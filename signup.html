<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>2025 서울국제유소년대회 참가신청서</title>
  <style>
    body { font-family: sans-serif; background: #f9f9f9; padding: 2rem; max-width: 800px; margin: auto; }
    h1 { text-align: center; color: #333; }
    label { display: block; margin: 1rem 0 0.3rem; }
    input, select { width: 100%; padding: 0.5rem; border: 1px solid #ccc; border-radius: 5px; font-size: 1rem; }
    button { margin-top: 1.5rem; padding: 0.8rem 1.2rem; font-size: 1rem; background-color: #4CAF50; color: white; border: none; border-radius: 5px; cursor: pointer; }
    button:hover { background-color: #45a049; }
    .success { margin-top: 1rem; color: green; }
    table { width: 100%; border-collapse: collapse; margin-top: 1rem; }
    th, td { border: 1px solid #ccc; padding: 0.5rem; text-align: center; }
    th { background-color: #eee; }
    .admin-link { text-align: right; margin-top: 2rem; }
    .admin-link a { color: #333; text-decoration: none; font-size: 0.9rem; }
    .notice { margin-top: 2rem; font-size: 0.9rem; color: #444; }
  </style>
</head>
<body>
  <h1>2025 서울국제유소년대회 참가신청서</h1>
  <form id="signupForm">
    <label for="division">종별</label>
    <select id="division" name="division" required>
      <option value="">선택</option>
      <option value="U12B">U12B (남)</option>
      <option value="U14B">U14B (남)</option>
      <option value="U14G">U14G (여)</option>
      <option value="U16B">U16B (남)</option>
      <option value="U16G">U16G (여)</option>
    </select>

    <label for="team">팀명</label>
    <input type="text" id="team" name="team" required />

    <label for="manager">대표자 이름</label>
    <input type="text" id="manager" name="manager" required />

    <label for="contact">대표자 연락처</label>
    <input type="text" id="contact" name="contact" placeholder="예: 010-1234-5678" required />

    <label>참가선수명단 (최대 20명)</label>
    <table id="playersTable">
      <thead>
        <tr>
          <th>순번</th>
          <th>이름</th>
          <th>생년월일</th>
          <th>등번호</th>
          <th>포지션</th>
        </tr>
      </thead>
      <tbody>
        <script>
          for (let i = 0; i < 20; i++) {
            document.write(`
              <tr>
                <td>${i + 1}</td>
                <td><input type="text" name="player_name_${i}" /></td>
                <td><input type="date" name="player_birth_${i}" /></td>
                <td><input type="number" name="player_number_${i}" /></td>
                <td>
                  <select name="player_position_${i}">
                    <option value="">선택</option>
                    <option value="G">G</option>
                    <option value="F">F</option>
                    <option value="C">C</option>
                  </select>
                </td>
              </tr>
            `);
          }
        </script>
      </tbody>
    </table>

    <p class="notice">
      ※ 상기 기재 내용이 사실과 다른 점이나 누락된 점이 발견될시 대회 참가가 취소될 수 있습니다. 최대한 자세하게 적어주시기 바랍니다.
    </p>

    <button type="submit">신청서 제출</button>
    <div class="success" id="successMessage"></div>
  </form>
  <div class="admin-link">
    <a href="admin.html" target="_blank">🔒 관리자 전용 신청 명단 보기</a>
  </div>

  <script>
    const SHEET_URL = 'https://script.google.com/macros/s/AKfycbz7vXeC2DDLI9R-Nmf_6cXJwzC2Nm9uDe_HNDVxJHQHVnGuMrAwwNOqS-G3vOiF1QdZ/exec'; // ← 본인 웹앱 URL

    document.getElementById('signupForm').addEventListener('submit', async function (e) {
      e.preventDefault();

      const data = {
        division: document.getElementById('division').value,
        team: document.getElementById('team').value,
        manager: document.getElementById('manager').value,
        contact: document.getElementById('contact').value,
        players: []
      };

      const rows = document.querySelectorAll('#playersTable tbody tr');
      rows.forEach((row, i) => {
        const name = row.querySelector(`[name='player_name_${i}']`).value;
        const birth = row.querySelector(`[name='player_birth_${i}']`).value;
        const number = row.querySelector(`[name='player_number_${i}']`).value;
        const position = row.querySelector(`[name='player_position_${i}']`).value;
        if (name) {
          data.players.push({ name, birth, number, position });
        }
      });

      try {
        const response = await fetch(SHEET_URL, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(data)
        });

        if (response.ok) {
          document.getElementById('successMessage').textContent = '신청이 정상적으로 접수되었습니다!';
          document.getElementById('signupForm').reset();
        } else {
          document.getElementById('successMessage').textContent = '오류가 발생했습니다. 다시 시도해 주세요.';
        }
      } catch (error) {
        document.getElementById('successMessage').textContent = '네트워크 오류입니다. 관리자에게 문의하세요.';
      }
    });
  </script>
</body>
</html>
